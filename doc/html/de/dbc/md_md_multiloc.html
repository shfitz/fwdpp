<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>fwdpp: Tutorial 2: Implementing multilocus simulations</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">fwdpp
   &#160;<span id="projectnumber">0.7.4</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Tutorial 2: Implementing multilocus simulations </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In order to simulate discontiguous genomic segments, one has two options within <b>fwdpp</b>:</p>
<ol type="1">
<li>Write mutation, recombination, and fitness policies that "do the right thing" for your model. For example, a mutation policy would need to know about the mutation rate at each locus, and appropriately assign mutations with the correct positions, fitness effects, etc.</li>
<li>Write separate mutation and recombination policies for each locus, and a fitness policy that calculates the fitness of a diploid over all loci.</li>
</ol>
<p>This document covers the latter method, which I call the "multilocus" part of <b>fwdpp</b>. I won't give any examples of the former method, as I'm opposed to the idea of having to develop, debug, and mainting large complex policies. But if you want to do things that way, read the <a class="el" href="../../d1/d7a/md_md_policies.html">tutorial on policies</a>, because what you are looking for is all in there.</p>
<h1>Differences from a "single-locus" simulation.</h1>
<p>The multi-locus API allows the simulation of non-contiguous, partially-linked regions. The recombination between these regions may be modeled as a Poisson process (<em>e.g.</em>, the number of crossovers between regions $i$ and $i+1$ is a Poisson random variable), or a binomial process (<em>e.g.</em>, representing the traditional notion of a genetic distance).</p>
<p>In terms of data types, a diploid is now a vector of objects that, at minimum, provide the same public interface as std::pair&lt;std::size_t,std:size_t&gt;.</p>
<p>Mutation models are per locus/region, and are stored in a vector-like container. The same is true of within- and between-region recombination models. For a system of $k$ loci, there must be $k$ mutations models, $k$ within-locus recombination models, and $k-1$ between-locus recombination rates.</p>
<p>For concrete examples, see the following files:</p>
<ul>
<li>diploid_ind_2locus.cc, which is an example program</li>
<li>sugar_multilocusTest.cc, which is part of the library's testing suite</li>
</ul>
<h1>Limitations</h1>
<p>The overload of <a class="el" href="../../dd/d84/namespacefwdpp.html#ab4197908734e2e302817107feaaf86b9">fwdpp::sample_diploid</a> for multi-region simulations is limited to modeling inter-locus recombination as either Poisson or binomial, and not as a mixture. This will addressed in a future version of the library. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
